(this["webpackJsonprule-game"]=this["webpackJsonprule-game"]||[]).push([[0],{163:function(e,t,a){e.exports=a.p+"static/media/bucket.dc583d8d.svg"},171:function(e){e.exports=JSON.parse('{"id":"N9Xh4VPn6","version":"0.0.0","games":{"m6bio4ou":{"id":"m6bio4ou","boardObjectsArrays":[],"name":"rand","ruleArray":"un4Q-9EI","useRandomBoardObjects":true,"numRandomBoardObjects":5,"restartIfNotCleared":true}},"ruleArrays":{"un4Q-9EI":{"id":"un4Q-9EI","stringified":"(10,square,*,*,[1,2]) (10,*,blue,10,[2,3])\\n(*,*,*,*,[ps,pc])\\n(*,*,*,*,[(p+1)%4])","name":"1"}},"boardObjectsArrays":{}}')},178:function(e,t,a){e.exports=a(312)},217:function(e,t,a){},312:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(33),o=a.n(c),u=a(8),l=a(58),i=a(173),s=a(335),d=a(340),b=a(339),m=a(342),O=a(314),f=function(e){var t=e.actionButton,a=e.layerId,c=Object(u.b)(),o=Object(r.useCallback)((function(){var e=t.action;Array.isArray(e)||(e=[e]),e.map((function(e){return c("function"===typeof e?e(a):e)}))}),[t,c,a]);return n.a.createElement(O.a,{primary:!0,onClick:o,label:t.label})},p=function(e){var t=e.layer,a=e.onLayerClose,c=Object(r.useCallback)((function(){return a(t.id)}),[t.id,a]);return n.a.createElement(d.a,{onEsc:t.closeOnEsc?c:void 0,onClickOutside:t.closeOnClickOutside?c:void 0,position:"top"},n.a.createElement(b.a,{pad:"large",overflow:"auto","data-cy":t.dataCyIdentifier},"string"===typeof t.title?n.a.createElement(m.a,{color:"red",level:"3"},t.title):t.title,t.description,n.a.createElement("div",null,t.actionButtons.map((function(e){return n.a.createElement(f,{actionButton:e,key:e.key,layerId:t.id})})))))},y=a(26),j=a(6),E=a(4),g=a(5),v=a(28),A=a(19),_=a.n(A),R=a(9),h=[{pos:R.a.BL,x:0,y:0,id:"bucket-".concat(R.a.BL)},{pos:R.a.TL,x:0,y:7,id:"bucket-".concat(R.a.TL)},{pos:R.a.BR,x:7,y:0,id:"bucket-".concat(R.a.BR)},{pos:R.a.TR,x:7,y:7,id:"bucket-".concat(R.a.TR)}],w=[R.b.RED,R.b.BLUE,R.b.BLACK,R.b.YELLOW],I=[R.c.SQUARE,R.c.TRIANGLE,R.c.STAR,R.c.CIRCLE],C=function(e){return e.page.page},S=function(e){return e.ruleRow.ruleRowIndex},B=Object(v.a)([S,function(e){return e.ruleRow.atomCounts}],(function(e,t){return Object.values(t).every((function(e){return e<=0}))})),k=Object(v.a)([function(e){return e.ruleRow.boardObjectsById}],(function(e){return Object.values(e)})),T=function(e){return e.ruleRow.boardObjectsToBucketsToAtoms},D=Object(v.a)([T],(function(e){return Object.entries(e).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1],c=Object.entries(n).filter((function(e){return Object(g.a)(e,2)[1].size>0})).map((function(e){return Object(g.a)(e,1)[0]}));return Object(E.a)({},e,Object(j.a)({},r,new Set(c)))}),{})})),N=Object(v.a)([k],(function(e){return e.every((function(e){return e.shape===R.c.CHECK}))})),M=Object(v.a)([B,D,N],(function(e,t,a){return e||Object.values(t).every((function(e){return 0===e.size}))||a}));Object(v.a)([k,T],(function(e,t){return e.filter((function(e){return e.id in t}))}));var L,G=function(e){return e.ruleRow.paused},x=function(e){return e.ruleRow.paused&&e.ruleRow.totalMoveHistory.length>0?e.ruleRow.totalMoveHistory[e.ruleRow.totalMoveHistory.length-1].dropped:void 0},U=function(e){return e.ruleRow.debugMode},P=Object(v.a)([U,k,D],(function(e,t,a){return e?t.reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},t.id,"".concat(Object.entries(t).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1];return"".concat(e).concat(r,": ").concat(n,"\n")}),""),"buckets: [").concat(t.id in a?Array.from(a[t.id]).toString():"","]\n")))}),{}):void 0})),Y=Object(v.a)([function(e){return e.ruleRow.totalMoveHistory},function(e){return e.ruleRow.initialBoardObjectsById},U],(function(e,t,a){return a?e.map((function(e,a){var r=e.dragged,n=e.dropped;return"----------------\n".concat(a,"\nBoardObject:\n").concat(Object.entries(t[r]).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1];return"".concat(e).concat(r,": ").concat(n,"\n")}),""),"\nBucket Dropped: ").concat(n)})):void 0})),q=function(e){return e.ruleRow.rawRuleArrayString},H=function(e){return e.ruleRow.gameCompleted},F=Object(v.a)([function(e){return e.layers.layerIds},function(e){return e.layers.layersById}],(function(e,t){return e.map((function(e){return t[e]}))})),J=function(e){return e.ruleArrays.byId},K=Object(v.a)([J,function(e){return e.ruleArrays.allIds}],(function(e,t){return t.map((function(t){return e[t]}))})),z=function(e){return e.boardObjectArrays.byId},W=Object(v.a)([z,function(e){return e.boardObjectArrays.allIds}],(function(e,t){return t.map((function(t){return e[t]}))})),V=function(e){return e.games.byId},Q=Object(v.a)([V,function(e){return e.games.allIds}],(function(e,t){return t.map((function(t){return e[t]}))})),X=(Object(v.a)([V,J,z],(function(e,t,a){return JSON.stringify({id:_()(),version:"0.0.0",games:e,ruleArrays:Object.entries(t).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1],c=(n.value,Object(y.a)(n,["value"]));return e[r]=c,e}),{}),boardObjectsArrays:Object.entries(a).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1],c=(n.stringified,Object(y.a)(n,["stringified"]));return e[r]=c,e}),{})})})),function(e){return e.notifications.byId}),$=function(e){return e.notifications.ids},Z=(Object(v.a)([X,$],(function(e,t){return t.map((function(t){return e[t]}))})),function(e){return e.ruleRow.order}),ee=a(2),te=Object(ee.createAction)("layers/ADD_LAYER",(function(e,t,a,r){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=arguments.length>6?arguments[6]:void 0,u=a.map((function(e){return void 0===e.key?Object(E.a)({},e,{key:_()()}):e}));return{title:e,description:t,actionButtons:u,id:r||_()(),closeOnEsc:n,closeOnClickOutside:c,dataCyIdentifier:o}}))(),ae=Object(ee.createAction)("layers/REMOVE_LAYER",(function(e){return{id:e}}))(),re=function(){var e=Object(u.c)(F),t=Object(u.b)();return n.a.createElement(n.a.Fragment,null,e.map((function(e){return n.a.createElement(p,{layer:e,onLayerClose:function(e){return t(ae(e))},key:e.id})})))},ne=a(326),ce=Object(ee.createAction)("layers/ADD_NOTIFICATION",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_()();return{title:e,id:t}}))(),oe=Object(ee.createAction)("layers/REMOVE_NOTIFICATION",(function(e){return{id:e}}))(),ue=function(e){var t=e.notificationId,a=Object(u.b)(),r=Object(u.c)((function(e){return X(e)[t]}));return n.a.createElement(d.a,{position:"bottom",modal:!1,margin:{vertical:"medium",horizontal:"small"},responsive:!1,plain:!0},n.a.createElement(b.a,{overflow:"auto",align:"center",direction:"row",gap:"small",justify:"between",round:"medium",elevation:"medium",pad:{vertical:"xsmall",horizontal:"large"},background:"status-ok"},n.a.createElement(m.a,{level:"3"},r.title),n.a.createElement(O.a,{icon:n.a.createElement(ne.a,{size:"medium"}),onClick:function(){return a(oe(r.id))}})))},le=function(){var e=Object(u.c)($);return n.a.createElement(n.a.Fragment,null,e.map((function(e){return n.a.createElement(ue,{notificationId:e,key:e})})))},ie=a(14),se=a(345),de=a(344),be=a(346),me=Object(ee.createAsyncAction)(["games/LOAD_GAMES_REQUEST",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_()();return{file:e,id:t}}],["games/LOAD_GAMES_SUCCESS",function(e,t,a,r){return{games:e,ruleArrays:t,boardObjectsArrays:a,id:r}}],["games/LOAD_GAMES_FAILURE",function(e,t){return{error:e,id:t}}])(),Oe=Object(ee.createAction)("games/ADD_GAME",(function(e,t,a,r,n,c){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:_()(),u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{name:e,id:o,ruleArray:t,boardObjectsArrays:a,useRandomBoardObjects:r,numRandomBoardObjects:n,numConsecutiveSuccessfulMovesBeforePromptGuess:c,restartIfNotCleared:u}}))(),fe=Object(ee.createAction)("games/SET_GAME_RULE_ARRAY",(function(e,t){return{id:e,ruleArray:t}}))(),pe=Object(ee.createAction)("games/SET_GAME_BOARD_OBJECTS_ARRAYS",(function(e,t){return{id:e,boardObjectsArrays:t}}))(),ye=Object(ee.createAction)("games/ENTER_GAME",(function(e){return{id:e}}))(),je=Object(ee.createAction)("games/REMOVE_GAME",(function(e){return{id:e}}))(),Ee=a(328),ge=a(327),ve=a(343),Ae=a(30),_e=a.n(Ae),Re=a(85),he=a.n(Re),we=a(162),Ie=a.n(we),Ce=a(65),Se=a(86),Be=a.n(Se),ke=a(163),Te=a.n(ke),De=n.a.forwardRef((function(e,t){var a,r=e.shape,c=e.className,o=e.shapeObjectId,u=e.onClick,l=e.debugInfo,i=e.color,s=e.canDrag;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{"data-tip":!0,"data-for":o,className:c,ref:t,"data-cy":o&&(a=o,"shape-object-".concat(a)),onClick:u,style:{display:"flex",justifyContent:"center",width:"100%",height:"100%",opacity:u&&!s&&R.d.has(r)?.25:1,cursor:u&&!s&&R.d.has(r)?"not-allowed":void 0},"data-shape":r},function(e){return{star:n.a.createElement(Ce.d,{size:"100%",color:e}),circle:n.a.createElement(Ce.b,{size:"100%",color:e}),square:n.a.createElement(Ce.c,{size:"100%",color:e}),triangle:n.a.createElement(Ce.e,{size:"100%",color:e}),happy:n.a.createElement("img",{src:Be.a,alt:"happy-face",height:"100%"}),bucket:n.a.createElement("img",{src:Te.a,alt:"bucket",height:"100%"}),check:n.a.createElement(Ce.a,{color:"green",size:"100%"}),nothing:null,"*":n.a.createElement("div",null,"*")}}(i)[r]),l&&n.a.createElement(Ie.a,{id:o,type:"error"},n.a.createElement("div",null,l.split("\n").map((function(e){return n.a.createElement("div",{key:e},e)})))))})),Ne=function(e,t){return 6*(t-1)+e},Me=function(e){return{x:(e-1)%6+1,y:Math.floor((e-1)/6)+1}},Le=function(e){return 36-6*Math.floor(e/6)+e%6-6+1},Ge=function(e){var t=e.boardObjects,a=e.width,c=void 0===a?"min(70vh, 100vw)":a,o=e.height,l=void 0===o?"min(70vh, 100vw)":o,i=Object(r.useMemo)((function(){return t.reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},Ne(t.x,t.y),t))}),{})}),[t]),s=Object(u.b)();return n.a.createElement(b.a,null,n.a.createElement(b.a,{width:c,height:l},n.a.createElement(ve.a,{fill:!0,rows:["1fr","".concat(6,"fr"),"1fr"],columns:["1fr","".concat(6,"fr"),"1fr"]},_e()(9).map((function(e){return 4===e?n.a.createElement(ve.a,{rows:_e()(6).map((function(){return"1fr"})),columns:_e()(6).map((function(){return"1fr"})),key:e},_e()(36).map((function(e){return n.a.createElement(b.a,{fill:!0,align:"center",justify:"center",border:!0,key:e},i[Le(e)]?n.a.createElement(De,{color:i[Le(e)].color,shape:i[Le(e)].shape}):n.a.createElement(de.a,null,Le(e)))}))):e%2===0?n.a.createElement(b.a,{fill:!0,border:!0,key:e},n.a.createElement(De,{shape:R.c.BUCKET})):n.a.createElement(b.a,{fill:!0,border:!0,key:e})})))),n.a.createElement(O.a,{label:"Export",onClick:function(){return s(te("Board Objects Array:",n.a.createElement(b.a,null,he()(t,{maxLength:20}).replace(/ /g,"\xa0").split("\n").map((function(e){return n.a.createElement(de.a,null,e)}))),[]))}}))},xe=function(e){var t=e.showEditButtons,a=e.game,c=Object(u.b)(),o=Object(u.c)((function(e){return a.ruleArray?J(e)[a.ruleArray]:void 0})),l=Object(u.c)(z);return n.a.createElement(b.a,{direction:"row",key:a.id,align:"center"},t&&n.a.createElement(O.a,{icon:n.a.createElement(ge.a,null),onClick:function(){return c(te("".concat(a.name," Game Preview:"),n.a.createElement(b.a,{height:{min:"auto"}},n.a.createElement(m.a,null,"Rule Array:"),null===o||void 0===o?void 0:o.stringified.split("\n").map((function(e,t){return n.a.createElement(se.a,{key:t,margin:"none"},e)})),(null===o||void 0===o?void 0:o.order)&&n.a.createElement(se.a,null," Order: JSON.stringify(ruleArray.order)"),n.a.createElement(m.a,null,"Board Objects:"),a.useRandomBoardObjects?"Using ".concat(a.numRandomBoardObjects," random board objects..."):a.boardObjectsArrays.map((function(e){return n.a.createElement(Ge,{key:e,boardObjects:l[e].value})}))),[{key:"close",label:"Close",action:ae("game-preview")}],"game-preview"))}}),n.a.createElement(O.a,{onClick:Object(r.useCallback)((function(){return c(ye(a.id))}),[c,a.id]),label:a.name}),t&&n.a.createElement(O.a,{onClick:function(){return c(te("Delete Game?","Are you sure you want to delete ".concat(a.name,"?"),[{key:"yes",label:"Yes",action:[ae("delete-game"),je(a.id)]},{key:"no",label:"No",action:ae("delete-game")}],"delete-game"))},icon:n.a.createElement(ne.a,null)}))},Ue=function(e){var t=e.showEditButtons,a=e.games,r=e.onDeleteAll;return n.a.createElement(b.a,{align:"center",gap:"medium"},a.map((function(e){return n.a.createElement(xe,{key:e.id,game:e,showEditButtons:t})})),t&&n.a.createElement(O.a,{icon:n.a.createElement(Ee.a,null),label:"Delete All",onClick:r}))},Pe=a(329),Ye=a(347),qe=a(341),He=a(348),Fe=function(e){var t=e.boardObjectsArrayId,a=e.onChange,r=e.checked,c=Object(u.c)((function(e){return z(e)[t].name}));return n.a.createElement(be.a,{label:c,onChange:a,checked:r})},Je=function(){var e=Object(u.b)(),t=Object(r.useState)(""),a=Object(g.a)(t,2),c=a[0],o=a[1],l=Object(u.c)(W),i=Object(r.useState)((function(){return l.reduce((function(e,t){var a=t.id;return Object(E.a)({},e,Object(j.a)({},a,!0))}),{})})),s=Object(g.a)(i,2),d=s[0],f=s[1],p=Object(r.useState)(void 0),y=Object(g.a)(p,2),v=y[0],A=y[1],_=Object(u.c)(K),R=Object(r.useState)(!1),h=Object(g.a)(R,2),w=h[0],I=h[1],C=Object(r.useState)(5),S=Object(g.a)(C,2),B=S[0],k=S[1],T=Object(r.useState)(),D=Object(g.a)(T,2),N=D[0],M=D[1];return n.a.createElement(b.a,{elevation:"large",align:"center",pad:"medium"},n.a.createElement(m.a,{level:"2"},"Add a New Game"),n.a.createElement(Pe.a,{onSubmit:function(){return e(Oe(c,v,l.filter((function(e){var t,a=e.id;return null===(t=d[a])||void 0===t||t})).map((function(e){return e.id})),w,B,N,void 0,!0))}},n.a.createElement(b.a,{align:"center",gap:"medium"},n.a.createElement(b.a,{align:"start"},n.a.createElement(Ye.a,{label:"Game Name"},n.a.createElement(qe.a,{required:!0,value:c,onChange:function(e){return o(e.target.value)},placeholder:"Name"})),n.a.createElement(Ye.a,{label:"New Rule Array",name:"RuleArray",pad:!0},n.a.createElement(b.a,null,_.length>0?n.a.createElement(b.a,{direction:"column",justify:"between"},_.map((function(t){return n.a.createElement(b.a,{direction:"row",key:t.id},n.a.createElement(O.a,{onClick:function(){return e(te("".concat(t.name," Rule Array Preview:"),"".concat(t.stringified,"\n").concat(t.order?"Order: ".concat(JSON.stringify(t.order)):""),[{key:"close",label:"Close",action:ae("rule-array-preview")}],"rule-array-preview"))},icon:n.a.createElement(ge.a,null)}),n.a.createElement(He.a,{checked:v===t.id,label:n.a.createElement(de.a,null,t.name),onChange:function(e){return e.target.checked&&A(t.id)},name:"RuleArray",required:!0}))}))):n.a.createElement(de.a,{margin:"small",size:"xsmall",color:"grey"},"(Empty... Add Rule Arrays)"))),n.a.createElement(Ye.a,{label:"Number of Consecutive Moves Before Prompt Guess"},n.a.createElement(qe.a,{type:"number",value:N,onChange:function(e){var t=e.target.value;return M(Number(t.trim()))}})),n.a.createElement(be.a,{label:"Use Random Board Objects",checked:w,onChange:function(e){var t=e.target.checked;return I(t)}}),w?n.a.createElement(Ye.a,{label:"Num Random Objects Per Display"},n.a.createElement(qe.a,{type:"number",value:B,onChange:function(e){var t=e.target.value;return k(Number(t.trim()))}})):n.a.createElement(Ye.a,{label:"Board Objects Arrays"},n.a.createElement(b.a,{gap:"none"},l.length>0?l.map((function(t){var a;return n.a.createElement(b.a,{direction:"row",justify:"start",key:t.id},n.a.createElement(O.a,{onClick:function(){return e(te("".concat(t.name," Board Objects Array Preview:"),n.a.createElement(Ge,{boardObjects:t.value}),[{key:"close",label:"Close",action:ae("board-objects-array-preview")}],"board-objects-array-preview"))},icon:n.a.createElement(ge.a,null)}),n.a.createElement(Fe,{boardObjectsArrayId:t.id,checked:null===(a=d[t.id])||void 0===a||a,onChange:function(e){var a=e.target.checked;return f((function(e){return Object(E.a)({},e,Object(j.a)({},t.id,a))}))}}))})):n.a.createElement(de.a,{margin:"small",size:"xsmall",color:"grey"},"(Empty... Add Board Objects Arrays)")))),n.a.createElement(O.a,{primary:!0,type:"submit",label:"Add Game"}))))},Ke=(a(164),a(349)),ze=Object(ee.createAsyncAction)(["rule-arrays/ADD_RULE_ARRAY_REQUEST",function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_()();return{name:e,rawRuleArray:t,rawOrder:a,id:r}}],["rule-arrays/ADD_RULE_ARRAY_SUCCESS",function(e,t,a,r,n){return{id:e,name:t,ruleArray:a,stringified:r,order:n}}],["rule-arrays/ADD_RULE_ARRAY_FAILURE",function(e){return{error:e}}])(),We=Object(ee.createAction)("rule-arrays/REMOVE_RULE_ARRAY",(function(e){return{id:e}}))(),Ve=function(){var e=Object(r.useState)(""),t=Object(g.a)(e,2),a=t[0],c=t[1],o=Object(r.useState)(""),l=Object(g.a)(o,2),i=l[0],s=l[1],d=Object(r.useState)(""),f=Object(g.a)(d,2),p=f[0],y=f[1],j=Object(u.b)();return n.a.createElement(b.a,{elevation:"large",align:"center",pad:"medium"},n.a.createElement(m.a,{level:"2"},"Add a New Rule Array"),n.a.createElement(Pe.a,{onSubmit:function(){return j(ze.request(a,i,p.trim().length>0?p:void 0))}},n.a.createElement(b.a,{align:"center"},n.a.createElement(b.a,{align:"start"},n.a.createElement(Ye.a,{label:"Name"},n.a.createElement(qe.a,{placeholder:"Name",onChange:Object(r.useCallback)((function(e){return c(e.target.value)}),[]),value:a})),n.a.createElement(Ye.a,{label:"Order"},n.a.createElement(qe.a,{value:p,onChange:function(e){var t=e.target.value;return y(t)}})),n.a.createElement(Ye.a,{label:"New Rule Array"},n.a.createElement(Ke.a,{required:!0,value:i,onChange:Object(r.useCallback)((function(e){return s(e.target.value)}),[]),size:"small",rows:20,cols:50,wrap:"off",placeholder:"(10,square,*,*,[1,2]) (10,*,blue,10,[2,3])\n(*,*,*,*,[ps,pc])\n(*,*,*,*,[(p+1)%4])"}))),n.a.createElement(O.a,{type:"submit",label:"Add Rule Array",primary:!0}))))},Qe=Object(ee.createAsyncAction)(["board-objects-arrays/ADD_BOARD_OBJECTS_ARRAY",function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{name:e,boardObjectsArrayString:t,addToAllGames:a}}],["board-objects-arrays/ADD_BOARD_OBJECTS_ARRAY_SUCCESS",function(e,t,a,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{id:e,boardObjectsArray:a,stringified:r,name:t,addToAllGames:n}}],["board-objects-arrays/ADD_BOARD_OBJECTS_ARRAY_FAILURE",function(e,t){return{error:e,boardObjectsArrayString:t}}])(),Xe=Object(ee.createAction)("board-objects-arrays/REMOVE_BOARD_OBJECTS_ARRAY",(function(e){return{id:e}}))(),$e=a(331);!function(e){e.RADIO_BUTTONS="RADIO_BUTTONS",e.COLORS="COLORS",e.SHAPES="SHAPES"}(L||(L={}));var Ze,et=function(e){var t=e.onClose,a=e.onDelete,r=e.onChange,c=e.boardObject,o=e.pos;return n.a.createElement(b.a,{gap:"small",pad:"small"},n.a.createElement(b.a,{direction:"row"},n.a.createElement(b.a,{border:{side:"bottom"},pad:"small",fill:"horizontal"},n.a.createElement(O.a,{label:"Delete",icon:n.a.createElement(Ee.a,null),onClick:a})),n.a.createElement(b.a,null,n.a.createElement(O.a,{icon:n.a.createElement(ne.a,null),onClick:t}))),c&&n.a.createElement(ve.a,{rows:["auto","auto"],columns:["auto","auto"],areas:[{name:L.COLORS,start:[1,0],end:[1,0]},{name:L.SHAPES,start:[0,1],end:[0,1]},{name:L.RADIO_BUTTONS,start:[1,1],end:[1,1]}]},n.a.createElement(b.a,{gridArea:L.COLORS,direction:"row",justify:"stretch"},w.map((function(e){return n.a.createElement(b.a,{justify:"center",align:"center",fill:!0},n.a.createElement(de.a,null,e))}))),n.a.createElement(b.a,{gridArea:L.SHAPES,direction:"column",justify:"stretch"},I.map((function(e){return n.a.createElement(b.a,{justify:"center",align:"center",fill:!0},n.a.createElement(de.a,null,e))}))),n.a.createElement(ve.a,{columns:{count:I.length,size:"auto"},gridArea:L.RADIO_BUTTONS,gap:"xxsmall"},_e()(w.length*I.length).map((function(e){var t=w[e%w.length],a=I[Math.floor(e/w.length)],u="".concat(t,"-").concat(a);return n.a.createElement(b.a,{justify:"center",align:"center",border:"all"},n.a.createElement(He.a,{name:u,key:u,onChange:function(){r&&r({color:t,shape:a,id:String(o),x:Me(o).x,y:Me(o).y})},checked:(null===c||void 0===c?void 0:c.color)===t&&(null===c||void 0===c?void 0:c.shape)===a,label:n.a.createElement(b.a,{height:"xxsmall",width:"xxsmall",justify:"center",align:"center"},n.a.createElement(De,{shape:a,color:t}))}))})))))},tt=function(e){var t=e.pos,a=e.boardObject,r=e.onChange,c=n.a.useState(!1),o=Object(g.a)(c,2),u=o[0],l=o[1];return n.a.createElement($e.a,{fill:!0,plain:!0,onOpen:function(){l(!0),a||r({color:R.b.RED,shape:R.c.SQUARE,id:String(t),x:Me(t).x,y:Me(t).y})},onClose:function(){return l(!1)},open:u,label:n.a.createElement(b.a,{fill:!0,align:"center",justify:"center",border:!0},a?n.a.createElement(De,{color:a.color,shape:a.shape}):n.a.createElement(de.a,null,t)),dropAlign:{top:"bottom",left:"left"},dropContent:n.a.createElement(et,{onClose:function(){l(!1)},onDelete:function(){r(void 0),l(!1)},onChange:r,pos:t,boardObject:a})})},at=function(e){return 36-6*Math.floor(e/6)+e%6-6+1},rt=function(e){var t=e.boardObjects,a=void 0===t?[]:t,c=e.onLoad,o=e.width,u=void 0===o?"min(70vh, 100vw)":o,l=e.height,i=void 0===l?"min(70vh, 100vw)":l,s=Object(r.useState)((function(){return a.reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},Ne(t.x,t.y),t))}),{})})),d=Object(g.a)(s,2),m=d[0],f=d[1];return n.a.createElement(ve.a,{fill:!0,rows:["auto","min-content"]},n.a.createElement(b.a,{width:u,height:i},n.a.createElement(ve.a,{fill:!0,rows:["1fr","".concat(6,"fr"),"1fr"],columns:["1fr","".concat(6,"fr"),"1fr"]},_e()(9).map((function(e){return 4===e?n.a.createElement(ve.a,{rows:_e()(6).map((function(){return"1fr"})),columns:_e()(6).map((function(){return"1fr"})),key:e},_e()(36).map((function(e){return n.a.createElement(tt,{key:e,pos:at(e),boardObject:m[at(e)],onChange:function(t){return f((function(a){return Object(E.a)({},a,Object(j.a)({},at(e),t))}))}})}))):e%2===0?n.a.createElement(b.a,{fill:!0,border:!0,key:e},n.a.createElement(De,{shape:R.c.BUCKET})):n.a.createElement(b.a,{fill:!0,border:!0,key:e})})))),n.a.createElement(O.a,{label:"Load",onClick:function(){return c(Object.values(m).filter((function(e){return void 0!==e})))}}))},nt=function(){var e=Object(r.useState)(""),t=Object(g.a)(e,2),a=t[0],c=t[1],o=Object(r.useState)(""),l=Object(g.a)(o,2),i=l[0],s=l[1],d=Object(u.b)(),f=Object(r.useState)(!1),p=Object(g.a)(f,2),y=p[0],j=p[1];return n.a.createElement(b.a,{elevation:"large",align:"center",pad:"medium"},n.a.createElement(m.a,{level:"2"},"Add a New Custom Board Objects Array"),n.a.createElement(Pe.a,{onSubmit:function(){return d(Qe.request(i,a,y))}},n.a.createElement(b.a,{align:"center"},n.a.createElement(b.a,{align:"start"},n.a.createElement(Ye.a,{label:"Name"},n.a.createElement(qe.a,{onChange:function(e){return s(e.target.value)},value:i,placeholder:"Name",required:!0})),n.a.createElement(O.a,{label:"Use Interactive Board Editor",onClick:function(){return d(te("Board Editor",n.a.createElement(rt,{onLoad:function(e){c(he()(e,{maxLength:20})),d(ae("board-editor"))},key:a}),[{key:"discard",label:"Discard",action:te("Unsaved board","Are you sure you want to discard",[{key:"yes",label:"Yes",action:[ae("board-editor"),ae("confirm-discard")]},{key:"no",label:"No",action:ae("confirm-discard")}],"confirm-discard")}],"board-editor",!1,!1))}}),n.a.createElement(Ye.a,{label:"New Board Objects",name:"BoardObjects",pad:!0},n.a.createElement(Ke.a,{required:!0,rows:20,cols:50,wrap:"off",onChange:function(e){return c(e.target.value)},value:a,size:"small",placeholder:'Custom Board Objects (JSON format):\nBoard Object Shape:\n{\n  id?: string; // If omitted, id will be position.\n  color: Color;\n  shape: Shape;\n  x: number;\n  y: number;\n}\n\nArray Example:\n[\n  {\n    "color": "red",\n    "id": "1",\n    "shape": "square",\n    "x": 1,\n    "y": 2\n  },\n  {\n    "color": "blue",\n    "id": "2",\n    "shape": "circle",\n    "x": 2,\n    "y": 3\n  }\n]\n'})),n.a.createElement(Ye.a,{label:"Add to all Games"},n.a.createElement(be.a,{checked:y,onChange:function(e){return j(e.target.checked)}}))),n.a.createElement(O.a,{primary:!0,type:"submit",label:"Add Board Objects Array"}))))},ct=function(){var e=Object(u.b)(),t=Object(r.useState)(!1),a=Object(g.a)(t,2),c=a[0],o=(a[1],Object(u.c)(Q));return n.a.createElement(b.a,{direction:"column",align:"center",gap:"medium",pad:"medium"},n.a.createElement(b.a,{align:"center",elevation:"large",fill:!0},n.a.createElement(b.a,{background:"brand",fill:!0,align:"center",pad:"medium",justify:"center"},n.a.createElement(m.a,null,"RuleGame Challenge"),n.a.createElement(se.a,{fill:!0},"Welcome to the RuleGame challenge. There are ",o.length," different rules. Each rule describes an allowed way of clearing some colored objects from a game board. To clear an object, you must grab it with the mouse, and drag it to the correct bucket. When you release it at the correct bucket, the bucket smiles, and the object\u2019s place turns into a check mark. If you release it at the wrong bucket, it jumps back onto the board where it was. When you hover over an object, the little hand will tell you that it can move. After you have cleared an entire display, you can give up, or ask for a new display. After you have cleared a few displays without too many errors, you can take a chance to guess at the rule. Please be patient after you guess because we require human judges to review your guesses.")),n.a.createElement(b.a,{pad:"medium"},n.a.createElement(m.a,null,"Enter a Game"),n.a.createElement(b.a,{pad:"small",fill:!0,align:"center",justify:"center"},o.length>0?n.a.createElement(Ue,{showEditButtons:c,onDeleteAll:function(){return e(te("Delete All Games?","Are you sure you want to delete all games?",[{key:"yes",label:"Yes",action:[ae("delete-all-games")].concat(Object(ie.a)(o.map((function(e){return je(e.id)}))))},{key:"no",label:"No",action:ae("delete-all-games")}],"delete-all-games"))},games:o}):n.a.createElement(de.a,null,"(Empty... Add a Game Below)")))),!1,c&&n.a.createElement(b.a,{direction:"row",gap:"medium",align:"stretch"},n.a.createElement(Je,null),n.a.createElement(Ve,null),n.a.createElement(nt,null)))},ot=Object(ee.createAction)("rule-row/MOVE",(function(e){return{dropAttempt:e}}))(),ut=Object(ee.createAction)("rule-row/TOUCH",(function(e){return{boardObjectId:e}}))(),lt=Object(ee.createAction)("rule-row/REMOVE_BOARD_OBJECT",(function(e){return{boardObjectId:e}}))(),it=Object(ee.createAction)("rule-row/LOAD_RULE_ARRAY",(function(e,t,a,r,n){var c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{boardObjects:e,ruleArray:t,gameId:a,rawRuleArrayString:r,order:n,restartIfNotCleared:c}}))(),st=Object(ee.createAction)("rule-row/SET_RULE_ROW_INDEX",(function(e){return{index:e}}))(),dt=Object(ee.createAction)("rule-row/END_RULE_ARRAY")(),bt=Object(ee.createAction)("rule-row/END_RULE_ROW")(),mt=Object(ee.createAction)("rule-row/RESUME_GAME")(),Ot=Object(ee.createAction)("rule-row/ENABLE_DEBUG_MODE")(),ft=Object(ee.createAction)("rule-row/DISABLE_DEBUG_MODE")(),pt=Object(ee.createAction)("rule-row/COMPLETE_GAME")(),yt=a(1),jt=Object(yt.default)(De).withConfig({displayName:"BoardObject__StyledShapeObject",componentId:"o98ija-0"})(["width:100%;height:100%;cursor:",";"],(function(e){return e.canDrag?"grab":"unset"})),Et=function(e){var t=e.className,a=e.item,r=e.onClick,c=e.shape,o=e.canDrag,u=(void 0===o||o)&&void 0!==a.buckets&&a.buckets.size>0,i=Object(l.c)({item:a,canDrag:u}),s=Object(g.a)(i,2)[1];return n.a.createElement(jt,{shape:c,className:t,onClick:r,ref:s,canDrag:u,shapeObjectId:a.id,debugInfo:a.debugInfo})},gt=Object(yt.default)(De).withConfig({displayName:"Bucket__StyledBucket",componentId:"sc-12iy3je-0"})(["filter:grayscale(",");"],(function(e){return e.isOver?.5:0})),vt=function(e){var t=e.className,a=e.onDrop,r=e.canDrop,c=e.dropped,o=e.bucket,u=Object(l.d)({canDrop:r,drop:a,accept:"object",collect:function(e){return{isOver:e.isOver()}}}),i=Object(g.a)(u,2),s=i[0].isOver,d=i[1];return n.a.createElement(gt,{ref:d,className:t,isOver:s,shape:c?R.c.HAPPY:R.c.BUCKET,shapeObjectId:o.id})},At=yt.default.div.withConfig({displayName:"Board__StyledBoard",componentId:"xdna11-0"})(["display:grid;grid-template-rows:repeat(",",","%);grid-template-columns:repeat(",",","%);height:100%;width:100%;position:relative;&:after{content:'';display:block;padding-bottom:100%;}"],8,12.5,8,12.5),_t=Object(yt.default)(Et).withConfig({displayName:"Board__StyledBoardObject",componentId:"xdna11-1"})(["grid-column:",";grid-row:",";color:",";"],(function(e){return e.x+1}),(function(e){return 8-e.y}),(function(e){return e.color})),Rt=Object(yt.default)(vt).withConfig({displayName:"Board__StyledBucket",componentId:"xdna11-2"})(["grid-column:",";grid-row:",";"],(function(e){return e.x+1}),(function(e){return 8-e.y})),ht=function(e){var t=e.onDrop,a=e.boardObjects,r=e.boardObjectsToBuckets,c=e.className,o=e.paused,u=e.onBoardObjectClick,l=e.disabledBucket,i=e.boardObjectsToDebugInfo;return n.a.createElement(At,{className:c},a.map((function(e){return n.a.createElement(_t,Object.assign({},e,{key:"".concat(e.x,"-").concat(e.y),item:Object(E.a)({},e,{type:"object",buckets:r[e.id],debugInfo:i&&i[e.id]}),onClick:function(){return!l&&u(e)}}))})),h.map((function(e){return n.a.createElement(Rt,Object.assign({},e,{key:"".concat(e.x,"-").concat(e.y),onDrop:t(e),canDrop:function(){return!o},dropped:l===e.pos,bucket:e}))})))},wt=Object(ee.createAction)("page/GO_TO_PAGE",(function(e){return{page:e}}))(),It=Object(ee.createAction)("game/NEXT_BOARD_OBJECTS_ARRAY",(function(){return{}}))(),Ct=Object(ee.createAction)("game/SET_GAME_ID",(function(e){return{gameId:e}}))(),St=Object(ee.createAction)("game/SET_BOARD_OBJECTS_ARRAY",(function(e){return{index:e}}))(),Bt=function(e){var t=e.gameId,a=Object(r.useState)(""),c=Object(g.a)(a,2),o=c[0],u=c[1];return n.a.createElement(Pe.a,{onSubmit:function(){var e=document.createElement("a");e.href="mailto:".concat("w2020rulegame@gmail.com","?subject=Rule Array Guess (GameID: ").concat(t,")&body=").concat(o),e.click()}},n.a.createElement(m.a,null,"Guess Rule"),n.a.createElement(Ye.a,{label:"Describe the rule"},n.a.createElement(qe.a,{name:"body",value:o,onChange:function(e){var t=e.target.value;return u(t)}})),n.a.createElement(O.a,{type:"submit",label:"Submit"}))};!function(e){e.GUESS_PROMPT="CY_LAYER_GUESS_PROMPT"}(Ze||(Ze={}));var kt,Tt=function(e){return e.ruleRow.currGameId},Dt=function(e){return e.ruleRow.currGameId&&e.games.byId[e.ruleRow.currGameId].name};!function(e){e.HEADING="HEADING",e.DEBUG_TOGGLE="DEBUG_TOGGLE",e.HISTORY="HISTORY",e.RULE_ARRAY="RULE_ARRAY",e.BOARD="BOARD",e.FORM="FORM"}(kt||(kt={}));var Nt,Mt,Lt=function(e){var t=e.className,a=Object(u.b)(),r=Object(u.c)(x),c=Object(u.c)(k),o=Object(u.c)(D),l=Object(u.c)(G),i=Object(u.c)(P),s=Object(u.c)(U),d=Object(u.c)(Y),f=Object(u.c)(S),p=Object(u.c)(q),y=Object(u.c)(H),j=Object(u.c)(Z),E=Object(u.c)(Tt),g=Object(u.c)(N),v=Object(u.c)(Dt);return n.a.createElement(b.a,{pad:"small","data-cy":"game"},n.a.createElement(ve.a,{rows:["auto","auto","min(70vh, 100vw)","auto"],columns:["auto","min(70vh, 100vw)","auto"],areas:[{name:kt.HEADING,start:[0,0],end:[2,0]},{name:kt.DEBUG_TOGGLE,start:[0,1],end:[2,1]},{name:kt.RULE_ARRAY,start:[0,2],end:[0,2]},{name:kt.BOARD,start:[1,2],end:[1,2]},{name:kt.HISTORY,start:[2,2],end:[2,2]},{name:kt.FORM,start:[0,3],end:[2,3]}]},n.a.createElement(b.a,{gridArea:kt.HEADING,align:"center"},n.a.createElement(m.a,null,v)),n.a.createElement(b.a,{gridArea:kt.DEBUG_TOGGLE,justify:"center",direction:"row"},!1),s&&p&&n.a.createElement(b.a,{gridArea:kt.RULE_ARRAY},j&&n.a.createElement(b.a,{width:"small",overflow:"auto",margin:{bottom:"small"}},n.a.createElement(de.a,{size:"small"},JSON.stringify(j))),p.split("\n").map((function(e,t){return n.a.createElement(b.a,{key:e,background:f!==t||y?"none":"yellow"},n.a.createElement(de.a,{size:"small"},e))})),n.a.createElement(b.a,{background:y?"yellow":"end"},n.a.createElement(de.a,{size:"small"},"loop/end"))),n.a.createElement(b.a,{gridArea:kt.BOARD,align:"center"},n.a.createElement(ht,{className:t,onBoardObjectClick:function(e){return a(ut(e.id))},boardObjects:c,boardObjectsToBuckets:o,boardObjectsToDebugInfo:i,paused:l,disabledBucket:r,onDrop:function(e){return function(t){a(ot({dragged:t.id,dropped:e.pos}))}}})),d&&n.a.createElement(b.a,{gridArea:kt.HISTORY,overflow:"auto"},"History Log:",d.map((function(e){return e.split("\n").map((function(e){return n.a.createElement("div",{key:e},e)}))}))),n.a.createElement(b.a,{gridArea:kt.FORM,align:"center"},!y&&n.a.createElement(b.a,{gap:"small"},n.a.createElement(O.a,{label:"Give up",onClick:function(){return a(wt("Entrance"))}}),n.a.createElement(O.a,{label:"New Display",onClick:function(){return a(It())}})),y&&n.a.createElement(b.a,{gap:"medium"},n.a.createElement(de.a,{"data-cy":"no-more-moves"},g?"You\u2019ve cleared all the shapes! Please guess the rule below\u201d!":"Error: Bad Rule Array (Board could not be cleared)"),n.a.createElement(O.a,{label:"Finish",onClick:function(){return a(wt("Entrance"))}}),n.a.createElement(O.a,{label:"New Display",onClick:function(){return a(It())}}),n.a.createElement(O.a,{label:"Try a new rule",onClick:function(){return a(wt("Entrance"))}}),n.a.createElement(Bt,{gameId:E})))))},Gt=function(){return n.a.createElement(Lt,null)},xt=function(){var e=Object(u.c)(C);return n.a.createElement(s.a,{full:!0,plain:!0},"Entrance"===e?n.a.createElement(ct,null):n.a.createElement(Gt,null),n.a.createElement(re,null),n.a.createElement(le,null))},Ut=(a(217),a(25)),Pt=(a(165),a(334)),Yt=a(166),qt=a(41),Ht=a(337),Ft=a(17),Jt=a(332),Kt=a(89),zt=Object(Ht.a)((function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(wt)),Object(Jt.a)((function(e){return"RuleGame"===e.payload.page})),Object(Kt.a)((function(){return t.value.ruleRow.numRuleRows>0?st(0):dt()})))})),Wt=a(338),Vt=a(333),Qt=a(336),Xt=Object(Ht.a)((function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(ot)),Object(Jt.a)((function(){return t.value.ruleRow.lastMoveSuccessful})),Object(Wt.a)(1e3),Object(Vt.a)((function(){var e,a=(e=t.value).games.byId[e.ruleRow.currGameId].numConsecutiveSuccessfulMovesBeforePromptGuess,r=[lt(t.value.ruleRow.totalMoveHistory[t.value.ruleRow.totalMoveHistory.length-1].dragged),mt()];return void 0!==a&&a>0&&function(e){return e.ruleRow.numConsecutiveSuccessfulMoves}(t.value)>=a&&r.push(te(n.a.createElement(b.a,{height:"25vh"},n.a.createElement(Qt.a,{src:Be.a,alt:"happy-face",fit:"contain"})),n.a.createElement(b.a,{align:"center"},n.a.createElement(m.a,null,"Would you like to guess the rule?"),n.a.createElement(b.a,{width:"50%"},n.a.createElement(Bt,{gameId:Tt(t.value)}))),[{action:function(e){return ae(e)},label:"Continue Playing"}],void 0,void 0,void 0,Ze.GUESS_PROMPT)),r})))}),(function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(bt)),Object(Kt.a)((function(){var e=t.value.ruleRow.restartIfNotCleared,a=S(t.value),r=function(e){return e.ruleRow.numRuleRows}(t.value),n=function(e){return e.ruleRow.ruleArrayInfos.every((function(e){return 0===e.successfulMoves}))}(t.value);return a===r-1&&(!e||e&&n)?dt():st((a+1)%r)})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(dt)),Object(Kt.a)((function(){return pt()})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(it)),Object(Kt.a)((function(){return wt("RuleGame")})))}),(function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)([st,lt])),Object(Jt.a)((function(){return M(t.value)})),Object(Kt.a)((function(){return bt()})))})),$t=a(57),Zt=Object(Ht.a)((function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(ze.request)),Object(Kt.a)((function(e){try{return ze.success(e.payload.id,e.payload.name,Object($t.a)(e.payload.rawRuleArray),e.payload.rawRuleArray,e.payload.rawOrder?JSON.parse(e.payload.rawOrder):void 0)}catch(t){return ze.failure(t)}})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(ze.failure)),Object(Kt.a)((function(e){var t=_()();return te("Error Parsing Rule Array:",e.payload.error.message,[{key:"close",label:"Close",action:ae(t)}],t)})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(ze.success)),Object(Kt.a)((function(e){return ce("Added new rule array: ".concat(e.payload.name))})))})),ea=Object(Ht.a)((function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(Qe.request)),Object(Kt.a)((function(e){try{return Qe.success(_()(),e.payload.name,JSON.parse(e.payload.boardObjectsArrayString).map((function(e){return e.id?e:Object(E.a)({},e,{id:String(Ne(e.x,e.y))})})),e.payload.boardObjectsArrayString)}catch(t){return Qe.failure(t,e.payload.boardObjectsArrayString)}})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(Qe.failure)),Object(Kt.a)((function(e){var t=_()();return te("Error Parsing Board Objects:","".concat(e.payload.boardObjectsArrayString,"\n").concat(e.payload.error.message),[{key:"close",label:"Close",action:ae(t)}],t)})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(Qe.success)),Object(Kt.a)((function(e){return ce("Added new board objects array: ".concat(e.payload.name))})))})),ta=a(118),aa=a.n(ta),ra=a(119),na=a.n(ra),ca=a(170),oa=a.n(ca),ua=function(e){return oa()((t=8,a=8,_e()(1,(t-2)*(a-2)+1)),e).map((function(e){return{id:_()(),color:na()(w),shape:na()(I),x:Me(e).x,y:Me(e).y}}));var t,a},la=Object(Ht.a)((function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(me.request)),Object(Vt.a)((function(e){var t,a,r,n;return aa.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,a=t.id,r=t.file,c.next=3,aa.a.awrap(new Response(new Blob([r])).text());case 3:return n=c.sent,c.abrupt("return",[a,n]);case 5:case"end":return c.stop()}}))})),Object(Kt.a)((function(e){var t=Object(g.a)(e,2),a=t[0],r=t[1];try{var n=JSON.parse(r),c=n.boardObjectsArrays,o=n.games,u=n.ruleArrays,l=Object.entries(u).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1];return Object(E.a)({},e,Object(j.a)({},r,Object(E.a)({},n,{value:Object($t.a)(n.stringified)})))}),{}),i=Object.entries(c).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1];return Object(E.a)({},e,Object(j.a)({},r,Object(E.a)({},n,{stringified:JSON.stringify(n)})))}),{});return me.success(o,l,i,a)}catch(s){return me.failure(s,a)}})))}),(function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(ye)),Object(Vt.a)((function(e){var a=e.payload.id,r=V(t.value)[a];if(void 0===r.ruleArray)return[te("Game ".concat(r.name," is missing its rule array."),"",[{key:"close",label:"Close",action:ae("missing-rule-array")}],"missing-rule-array")];var n=J(t.value)[r.ruleArray];if(r.useRandomBoardObjects)return[Ct(a),it(ua(r.numRandomBoardObjects),n.value,a,n.stringified,n.order,r.restartIfNotCleared),wt("RuleGame")];if(0===r.boardObjectsArrays.length)return[te("Game ".concat(r.name," is missing board objects arrays."),"",[{key:"close",label:"Close",action:ae("missing-rule-array")}],"missing-rule-array")];var c=z(t.value)[r.boardObjectsArrays[0]];return[Ct(a),St(0),it(c.value,n.value,a,n.stringified,n.order,r.restartIfNotCleared),wt("RuleGame")]})))}),(function(e){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(Oe)),Object(Kt.a)((function(e){return ce("Added game: ".concat(e.payload.name))})))})),ia=Object(Ht.a)((function(e,t){return e.pipe(Object(Jt.a)(Object(ee.isActionOf)(It)),Object(Vt.a)((function(){var e,a=V(t.value)[(e=t.value,e.game.currGameId)],r=J(t.value)[a.ruleArray];if(a.useRandomBoardObjects)return[it(ua(a.numRandomBoardObjects),r.value,a.id,r.stringified,r.order,a.restartIfNotCleared),wt("RuleGame")];var n=function(e){return e.game.currBoardObjectsArrayIndex}(t.value);return[St((n+1)%a.boardObjectsArrays.length),it(z(t.value)[a.boardObjectsArrays[n]].value,r.value,a.id,r.stringified,r.order,a.restartIfNotCleared),wt("RuleGame")]})))})),sa=a(171),da=Object(Ht.a)(zt,Xt,Zt,ea,la,ia,(function(e){return e.pipe(Object(Jt.a)((function(e){return e.type===Ft.h})),Object(Kt.a)((function(){return me.request(new File([JSON.stringify(sa)],"temp"))})))})),ba={page:"Entrance"},ma=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ba,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(wt):return Object(E.a)({},e,{page:t.payload.page});default:return e}},Oa=a(172),fa=a.n(Oa),pa={atomCounts:{},boardObjectsToBucketsToAtoms:{},initialBoardObjectsById:{},boardObjectsById:{},totalMoveHistory:[],touchAttempts:[],dropAttempts:[],ruleRowIndex:NaN,numRuleRows:0,lastMoveSuccessful:!1,paused:!1,debugMode:!1,rawRuleArrayString:void 0,gameCompleted:!1,parsingRuleArray:!1,error:void 0,order:[],numConsecutiveSuccessfulMoves:0,currGameId:void 0,restartIfNotCleared:!1,ruleRowsCompleted:0,ruleArray:void 0,ruleArrayInfos:[]},ya=function(e,t,a,r,n){return Object.values(a).filter((function(e){return e.shape!==R.c.CHECK})).reduce((function(a,c){var o;return Object(E.a)({},a,Object(j.a)({},c.id,Object(E.a)({},n.filter(function(e,t){return function(a){return t[a.id]>0&&(a.color===R.b.ANY||a.color===e.color)&&(a.shape===R.c.ANY||a.shape===e.shape)&&(Number.isNaN(a.position)||Ne(e.x,e.y)===a.position)}}(c,r)).reduce((function(a,r){return r.fns.map((function(a){return a(c.id,e,t)})).forEach((function(e){Number.isFinite(e)&&a[e].add(r.id)})),a}),(o={},Object(j.a)(o,R.a.TR,new Set),Object(j.a)(o,R.a.TL,new Set),Object(j.a)(o,R.a.BR,new Set),Object(j.a)(o,R.a.BL,new Set),o)))))}),{})},ja=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(it):var a=fa()(t.payload.boardObjects,(function(e){return e.id}));return Object(E.a)({},e,{boardObjectsToBucketsToAtoms:{},initialBoardObjectsById:a,boardObjectsById:a,ruleRowIndex:NaN,numRuleRows:t.payload.ruleArray.length,totalMoveHistory:[],dropAttempts:[],touchAttempts:[],lastMoveSuccessful:!1,paused:!1,gameCompleted:!1,parsingRuleArray:!1,rawRuleArrayString:t.payload.rawRuleArrayString,order:t.payload.order,numConsecutiveSuccessfulMoves:0,currGameId:t.payload.gameId,restartIfNotCleared:t.payload.restartIfNotCleared,ruleRowsCompleted:0,ruleArray:t.payload.ruleArray,ruleArrayInfos:t.payload.ruleArray.map((function(){return{successfulMoves:0}}))});case Object(ee.getType)(st):var r=e.ruleArray[t.payload.index].reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},t.id,t.counter))}),{}),n=ya(e.totalMoveHistory,e.initialBoardObjectsById,e.boardObjectsById,r,e.ruleArray[t.payload.index]),c=n;if(e.order){var o=Object.entries(n).reduce((function(t,a){var r=Object(g.a)(a,2),n=r[0],c=r[1];if(Object.values(c).some((function(e){return e.size>0}))){var o=Ne(e.initialBoardObjectsById[n].x,e.initialBoardObjectsById[n].y);o in t||(t[o]=[]),t[o].push(n)}return t}),{}),u=e.order.find((function(e){return e in o}));if(u){var l=o[u];c=l.reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},t,n[t]))}),{})}}return Object(E.a)({},e,{atomCounts:r,ruleRowIndex:t.payload.index,boardObjectsToBucketsToAtoms:c,ruleRowsCompleted:e.ruleRowsCompleted+1,ruleArrayInfos:e.ruleArrayInfos.map((function(e,a){return a!==t.payload.index?e:Object(E.a)({},e,{successfulMoves:0})}))});case Object(ee.getType)(ut):return Object(E.a)({},e,{touchAttempts:[].concat(Object(ie.a)(e.touchAttempts),[t.payload.boardObjectId])});case Object(ee.getType)(ot):var i,s,d,b=t.payload.dropAttempt,m=b.dragged,O=b.dropped,f=Array.from(null!==(i=null===(s=e.boardObjectsToBucketsToAtoms)||void 0===s?void 0:null===(d=s[m])||void 0===d?void 0:d[O])&&void 0!==i?i:[]);if(0===f.length)return Object(E.a)({},e,{dropAttempts:[].concat(Object(ie.a)(e.dropAttempts),[t.payload.dropAttempt]),lastMoveSuccessful:!1,numConsecutiveSuccessfulMoves:0});var p=[].concat(Object(ie.a)(e.totalMoveHistory),[t.payload.dropAttempt]),y=f.reduce((function(t,a){return Object(E.a)({},t,Object(j.a)({},a,e.atomCounts[a]-1))}),e.atomCounts);return Object(E.a)({},e,{atomCounts:y,boardObjectsById:Object(E.a)({},e.boardObjectsById,Object(j.a)({},m,Object(E.a)({},e.boardObjectsById[m],{shape:R.c.CHECK}))),dropAttempts:[].concat(Object(ie.a)(e.dropAttempts),[t.payload.dropAttempt]),totalMoveHistory:p,lastMoveSuccessful:!0,paused:!0,numConsecutiveSuccessfulMoves:e.numConsecutiveSuccessfulMoves+1,ruleArrayInfos:e.ruleArrayInfos.map((function(t,a){return a!==e.ruleRowIndex?t:Object(E.a)({},t,{successfulMoves:e.ruleArrayInfos[e.ruleRowIndex].successfulMoves+1})}))});case Object(ee.getType)(lt):var v=ya(e.totalMoveHistory,e.initialBoardObjectsById,e.boardObjectsById,e.atomCounts,e.ruleArray[e.ruleRowIndex]),A=v;if(e.order){var _=Object.entries(v).reduce((function(t,a){var r=Object(g.a)(a,2),n=r[0],c=r[1];if(Object.values(c).some((function(e){return e.size>0}))){var o=Ne(e.initialBoardObjectsById[n].x,e.initialBoardObjectsById[n].y);o in t||(t[o]=[]),t[o].push(n)}return t}),{}),h=e.order.find((function(e){return e in _}));if(h){var w=_[h];A=w.reduce((function(e,t){return Object(E.a)({},e,Object(j.a)({},t,v[t]))}),{})}}return Object(E.a)({},e,{boardObjectsToBucketsToAtoms:A});case Object(ee.getType)(mt):return Object(E.a)({},e,{paused:!1});case Object(ee.getType)(Ot):return Object(E.a)({},e,{debugMode:!0});case Object(ee.getType)(ft):return Object(E.a)({},e,{debugMode:!1});case Object(ee.getType)(pt):return Object(E.a)({},e,{gameCompleted:!0});default:return e}},Ea=a(38),ga={layersById:{},layerIds:[]},va=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ga,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(te):return Object(E.a)({},e,{layersById:Object(E.a)({},e.layersById,Object(j.a)({},t.payload.id,{id:t.payload.id,title:t.payload.title,description:t.payload.description,actionButtons:t.payload.actionButtons,closeOnClickOutside:t.payload.closeOnClickOutside,closeOnEsc:t.payload.closeOnEsc,dataCyIdentifier:t.payload.dataCyIdentifier})),layerIds:[].concat(Object(ie.a)(e.layerIds),[t.payload.id])});case Object(ee.getType)(ae):var a=e.layersById,r=t.payload.id,n=(a[r],Object(y.a)(a,[r].map(Ea.a)));return Object(E.a)({},e,{layersById:n,layerIds:e.layerIds.filter((function(e){return e!==t.payload.id}))});default:return e}},Aa=a(60),_a=function(e,t){var a=e.indexOf(t);return[].concat(Object(ie.a)(e.slice(0,a)),Object(ie.a)(e.slice(a+1)))};!function(e){e.GAMES="GAMES_0",e.RULE_ARRAYS="RULE_ARRAYS_0",e.BOARD_OBJECTS_ARRAYS="BOARD_OBJECTS_ARRAYS_0"}(Mt||(Mt={}));var Ra=(Nt={},Object(j.a)(Nt,Mt.GAMES,0),Object(j.a)(Nt,Mt.RULE_ARRAYS,0),Object(j.a)(Nt,Mt.BOARD_OBJECTS_ARRAYS,0),Nt),ha={byId:{},allIds:[],isRequesting:!1},wa=Object(qt.b)({version:Ra[Mt.RULE_ARRAYS],key:Mt.RULE_ARRAYS,storage:Aa.a,transforms:[Object(qt.a)(null,(function(e,t){return"byId"===t?Object.entries(e).reduce((function(e,t){var a=Object(g.a)(t,2),r=a[0],n=a[1];return Object(E.a)({},e,Object(j.a)({},r,Object(E.a)({},n,{value:Object($t.a)(n.stringified)})))}),{}):e}))]},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ha,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(ze.request):return Object(E.a)({},e,{isRequesting:!0});case Object(ee.getType)(ze.success):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,{id:t.payload.id,value:t.payload.ruleArray,stringified:t.payload.stringified,name:t.payload.name,order:t.payload.order})),allIds:[].concat(Object(ie.a)(e.allIds),[t.payload.id]),isRequesting:!1});case Object(ee.getType)(ze.failure):return Object(E.a)({},e,{isRequesting:!1});case Object(ee.getType)(We):var a=e.byId,r=t.payload.id,n=(a[r],Object(y.a)(a,[r].map(Ea.a)));return Object(E.a)({},e,{byId:n,allIds:_a(e.allIds,t.payload.id)});case Object(ee.getType)(me.success):var c=new Set(e.allIds);return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,{},t.payload.ruleArrays),allIds:[].concat(Object(ie.a)(e.allIds),Object(ie.a)(Object.values(t.payload.ruleArrays).filter((function(e){return!c.has(e.id)})).map((function(e){return e.id}))))});default:return e}})),Ia={byId:{},allIds:[],isRequesting:!1},Ca=Object(qt.b)({version:Ra[Mt.BOARD_OBJECTS_ARRAYS],key:Mt.BOARD_OBJECTS_ARRAYS,storage:Aa.a},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ia,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(Qe.request):return Object(E.a)({},e,{isRequesting:!0});case Object(ee.getType)(Qe.success):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,{id:t.payload.id,value:t.payload.boardObjectsArray,stringified:t.payload.stringified,name:t.payload.name})),allIds:[].concat(Object(ie.a)(e.allIds),[t.payload.id]),isRequesting:!1});case Object(ee.getType)(Qe.failure):return Object(E.a)({},e,{isRequesting:!1});case Object(ee.getType)(Xe):var a=e.byId,r=t.payload.id,n=(a[r],Object(y.a)(a,[r].map(Ea.a)));return Object(E.a)({},e,{byId:n,allIds:_a(e.allIds,t.payload.id)});case Object(ee.getType)(me.success):var c=new Set(e.allIds);return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,{},t.payload.boardObjectsArrays),allIds:[].concat(Object(ie.a)(e.allIds),Object(ie.a)(Object.values(t.payload.boardObjectsArrays).filter((function(e){return!c.has(e.id)})).map((function(e){return e.id}))))});default:return e}})),Sa={byId:{},allIds:[]},Ba=Object(qt.b)({version:Ra[Mt.GAMES],key:Mt.GAMES,storage:Aa.a},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(Oe):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,{id:t.payload.id,boardObjectsArrays:Object(ie.a)(t.payload.boardObjectsArrays),name:t.payload.name,ruleArray:t.payload.ruleArray,useRandomBoardObjects:t.payload.useRandomBoardObjects,numRandomBoardObjects:t.payload.numRandomBoardObjects,numConsecutiveSuccessfulMovesBeforePromptGuess:t.payload.numConsecutiveSuccessfulMovesBeforePromptGuess,restartIfNotCleared:t.payload.restartIfNotCleared})),allIds:[].concat(Object(ie.a)(e.allIds),[t.payload.id])});case Object(ee.getType)(je):var a=e.byId,r=t.payload.id,n=(a[r],Object(y.a)(a,[r].map(Ea.a)));return Object(E.a)({},e,{byId:n,allIds:_a(e.allIds,t.payload.id)});case Object(ee.getType)(fe):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,Object(E.a)({},e.byId[t.payload.id],{ruleArray:t.payload.ruleArray})))});case Object(ee.getType)(pe):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,Object(E.a)({},e.byId[t.payload.id],{boardObjectsArrays:Object(ie.a)(t.payload.boardObjectsArrays)})))});case Object(ee.getType)(me.success):var c=new Set(e.allIds);return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,{},t.payload.games),allIds:[].concat(Object(ie.a)(e.allIds),Object(ie.a)(Object.values(t.payload.games).filter((function(e){return!c.has(e.id)})).map((function(e){return e.id}))))});case Object(ee.getType)(Qe.success):return Object(E.a)({},e,{byId:Object.entries(e.byId).reduce((function(e,a){var r=Object(g.a)(a,2),n=r[0],c=r[1];return Object(E.a)({},e,Object(j.a)({},n,Object(E.a)({},c,{boardObjectsArrays:[].concat(Object(ie.a)(c.boardObjectsArrays),[t.payload.id])})))}),{})});default:return e}})),ka={byId:{},ids:[]},Ta=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ka,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(ce):return Object(E.a)({},e,{byId:Object(E.a)({},e.byId,Object(j.a)({},t.payload.id,{id:t.payload.id,title:t.payload.title})),ids:[].concat(Object(ie.a)(e.ids),[t.payload.id])});case Object(ee.getType)(oe):var a=e.byId,r=t.payload.id,n=(a[r],Object(y.a)(a,[r].map(Ea.a)));return Object(E.a)({},e,{byId:n,ids:e.ids.filter((function(e){return e!==t.payload.id}))});default:return e}},Da={currBoardObjectsArrayIndex:void 0,currGameId:void 0},Na=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Da,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(ee.getType)(Ct):return Object(E.a)({},e,{currGameId:t.payload.gameId,currBoardObjectsArrayIndex:0});case Object(ee.getType)(St):return Object(E.a)({},e,{currBoardObjectsArrayIndex:t.payload.index});default:return e}},Ma=function(){return Object(Ut.combineReducers)({page:ma,ruleRow:ja,layers:va,ruleArrays:wa,boardObjectArrays:Ca,games:Ba,notifications:Ta,game:Na})},La=Object(Pt.a)(),Ga=[La];Object(Yt.createDynamicMiddlewares)();window.__REACT_DEVTOOLS_GLOBAL_HOOK__&&(window.__REACT_DEVTOOLS_GLOBAL_HOOK__.inject=function(){});var xa=Ut.compose,Ua=Object(Ut.createStore)(Ma(),xa(Ut.applyMiddleware.apply(void 0,Ga))),Pa=Object(qt.c)(Ua);window.Cypress;a.d(t,"store",(function(){return Ya}));var Ya=(La.run(da),{store:Ua,persistor:Pa}).store;o.a.render(n.a.createElement(u.a,{store:Ya},n.a.createElement(l.b,{backend:i.a},n.a.createElement(xt,null))),document.getElementById("root"))},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return parseRuleArray}));var _home_vmenkov_w2020_Rule_Game_master_packages_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_home_vmenkov_w2020_Rule_Game_master_packages_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),shortid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19),shortid__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(shortid__WEBPACK_IMPORTED_MODULE_2__),_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9),convertRawAtomFnToAtomFn=function(e){return function(t,a,r){var n=Object(_home_vmenkov_w2020_Rule_Game_master_packages_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(a).reverse(),c=function(e){var t=n.find(e);return void 0!==t?t.dropped:void 0};return e(c((function(){return!0})),c((function(e){return r[e.dragged].color===r[t].color&&r[e.dragged].shape===r[t].shape})),c((function(e){return r[e.dragged].color===r[t].color})),c((function(e){return r[e.dragged].shape===r[t].shape})))}},parseAtomRawFnString=function parseAtomRawFnString(rawAtomFnString){if("*"===rawAtomFnString)return[0,1,2,3].map((function(e){return function(){return e}}));var regex=/^\[(.+)]$/,fnsRawStrings=rawAtomFnString.match(regex);if(!fnsRawStrings||2!==fnsRawStrings.length)throw Error("Bad function value: ".concat(rawAtomFnString));var fnStrings=fnsRawStrings[1].split(",");return fnStrings.map((function(fnString){var evalFn=eval("(p=NaN, pcs=NaN, pc=NaN, ps=NaN) => ".concat(fnString));return convertRawAtomFnToAtomFn(evalFn)}))},parseAtomString=function(e){var t=/\((\d+|\*),(.+),(.+),(\d+|\*+),(\*|\[.*])\)/.exec(e);if(null===t)throw Error("Invalid atom syntax: ".concat(e,"\n\nFYI:\nCorrect Syntax: (counter,shape,color,position,[bucketFunction1,...])\nCorrect example: (10,*,green,10,[2,(pc+1)%4])\n\nRemember, spaces are only used for separating multiple atoms in the same row.\nExample:\n(10,square,*,*,[1,2]) (10,*,green,10,[2,3])"));var a=Object(_home_vmenkov_w2020_Rule_Game_master_packages_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(t,6),r=a[1],n=a[2],c=a[3],o=a[4],u=a[5],l="*"===r?1/0:Number(r),i=Number(o),s=[],d=n,b=Object.values(_types__WEBPACK_IMPORTED_MODULE_3__.c).filter((function(e){return _types__WEBPACK_IMPORTED_MODULE_3__.d.has(e)}));b.includes(d)||s.push('"'.concat(n,'" is not a valid shape.\n\nSupported shapes: ').concat(b.join(", "),"\nSyntax: (counter,shape,color,[bucketFunction1,...])"));var m=c;Object.values(_types__WEBPACK_IMPORTED_MODULE_3__.b).includes(m)||s.push('"'.concat(c,'" is not a valid color.\n\nSupported colors: ').concat(Object.values(_types__WEBPACK_IMPORTED_MODULE_3__.b).join(", "),"\nSyntax: (counter,shape,color,[bucketFunction1,...])"));var O=u;if(s.length>0)throw Error("Invalid atom: ".concat(e,"\n\nDetails:\n ").concat(s.join("\n\n")));return{id:shortid__WEBPACK_IMPORTED_MODULE_2___default.a.generate(),counter:l,shape:d,position:i,color:m,fns:parseAtomRawFnString(O)}},parseRow=function(e){return e.split(" ").map(parseAtomString)},parseRuleArray=function(e){return e.split("\n").map(parseRow)},_unused_webpack_default_export=parseRow},86:function(e,t,a){e.exports=a.p+"static/media/smiley-face.770bd064.png"},9:function(e,t,a){"use strict";var r,n,c;a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return o})),function(e){e[e.TL=0]="TL",e[e.TR=1]="TR",e[e.BR=2]="BR",e[e.BL=3]="BL"}(r||(r={})),function(e){e.ANY="*",e.RED="red",e.BLUE="blue",e.BLACK="black",e.YELLOW="yellow",e.GREEN="green"}(n||(n={})),function(e){e.ANY="*",e.SQUARE="square",e.TRIANGLE="triangle",e.STAR="star",e.CIRCLE="circle",e.NOTHING="nothing",e.BUCKET="bucket",e.HAPPY="happy",e.CHECK="check"}(c||(c={}));var o=new Set([c.ANY,c.SQUARE,c.TRIANGLE,c.STAR,c.CIRCLE]);new Set([n.ANY,n.RED,n.BLUE,n.BLACK,n.YELLOW])}},[[178,1,2]]]);
//# sourceMappingURL=main.48d4d54a.chunk.js.map